---
title: "Stats_display"
author: "Sean Goral"
date: "2/6/2020"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(knitr)
library(kableExtra)
library(tidyverse)
library(leaflet)
library(RColorBrewer)
library(maptools)
library(sf)
library(rgeos)
library(dplyr)
library(shiny)
library(shinydashboard)
library(RPostgreSQL)
library(dbplyr)
library(lubridate)
library(units)
library(data.table)
library(here)
```

```{r}
source('~/github/whalesafe4r/R/db.R')
#source('~/github/s4wr/R/logfile_funs.R')
source('~/github/whalesafe4r/R/crawlers.R')
source('~/github/whalesafe4r/R/readers.R')
source('~/github/whalesafe4r/R/utils.R')
source('~/github/whalesafe4r/R/seg_stats.R')
```

```{r}


operator_stats_2019 = operator_statistics(data= vsr_segs_ihs, yr=2019) 

operator_stats_2019_filtered = operator_stats_2019%>% 
  filter(operator_stats_2019$`total distance (nautcal miles)` >=50)


```

```{r}

library(ggplot2)
# counts
theme_set(theme_bw()) 
g=ggplot(data.frame(operator_stats_2019_filtered), aes(x=grade)) +
  geom_bar() +  
  theme(plot.title = element_text(hjust = 0.5)) + 
  ggtitle("VSR Cooperation Grade Distribution: 2019") + 
  labs(caption="Source: Benioff Ocean Initiative",
       x="VSR Cooperation Grade",
       y="Count") +
  # geom_text(stat='count', aes(label=..count..), vjust=1.5, color="white")
      geom_text(stat='count', aes(label=..count..), position = position_stack(vjust = 0.5),size=4, color = "white")


g
```



```{r}

t=operator_stats_2019 %>% 
  select(operator, grade, "compliance score (reported speed)", "total distance (km)", "total distance (nautcal miles)", "distance (nautcal miles) under 10 knots", "distance (nautcal miles) over 10 knots") %>% 
  kable(escape = F) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "responsive")) 

t
```
 

