---
title: "Stats_display"
author: "Sean Goral"
date: "2/6/2020"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(knitr)
library(kableExtra)
library(tidyverse)
library(leaflet)
library(RColorBrewer)
library(maptools)
library(sf)
library(rgeos)
library(dplyr)
library(shiny)
library(shinydashboard)
library(RPostgreSQL)
library(dbplyr)
library(lubridate)
library(units)
library(data.table)
library(here)
```

```{r}
source('~/github/whalesafe4r/R/db.R')
#source('~/github/s4wr/R/logfile_funs.R')
<<<<<<< HEAD
source('~/github/whalesafe4r/R/crawlers.R')
source('~/github/whalesafe4r/R/readers.R')
source('~/github/whalesafe4r/R/utils.R')
source('~/github/whalesafe4r/R/seg_stats.R')
=======
source('~/github/s4wr/R/crawlers.R')
source('~/github/s4wr/R/readers.R')
source('~/github/s4wr/R/utils.R')
source('~/github/s4wr/R/seg_stats.R')
>>>>>>> f1e18544d5cf31f60baab4994cdce7e0e92e2373
```


```{r}
<<<<<<< HEAD
operator_stats = operator_statistics(yr=2019)
=======

vsr_segs_ihs = .merge_ihs_vsr() 

vsr_segs_2019 = vsr_segs_ihs %>% 
  filter(vsr_segs_ihs$gt >= 300) %>% filter(beg_dt >= "2019-01-01")

operator_stats_2019 = operator_statistics(data = vsr_segs_2019)
>>>>>>> f1e18544d5cf31f60baab4994cdce7e0e92e2373
```

```{r}


library(ggplot2)
# counts
theme_set(theme_bw()) 
g=ggplot(data.frame(operator_stats_2019), aes(x=grade)) +
<<<<<<< HEAD
  geom_bar() +  
  theme(plot.title = element_text(hjust = 0.5)) + 
  ggtitle("VSR Cooperation Grade Distribution: 2019") + 
  labs(caption="Source: Benioff Ocean Initiative",
       x="VSR Cooperation Grade",
       y="Count") +
  # geom_text(stat='count', aes(label=..count..), vjust=1.5, color="white")
      geom_text(stat='count', aes(label=..count..), position = position_stack(vjust = 0.5),size=4, color = "white")

=======
  geom_bar(color="black") +  theme(plot.title = element_text(hjust = 0.5))+  geom_text(stat='count', aes(label=..count..), color="white", position = position_stack(vjust = 0.5),size=4, show.legend = FALSE) + ggtitle("VSR Cooperation Grade Distribution (2019)") + labs(
       caption="Source: Benioff Ocean Initiative",
       x="VSR Cooperation Grade",
       y="Count")   
>>>>>>> f1e18544d5cf31f60baab4994cdce7e0e92e2373


g
```



```{r}

t = operator_stats %>% 
  select(operator, 
         grade, 
         "compliance score (reported speed)", 
         "total distance (km)", 
         "total distance (nautcal miles)", 
         "distance (nautcal miles) under 10 knots", 
         "distance (nautcal miles) over 10 knots") %>% 
  kable(escape = F) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "responsive")) 

t
```
 

